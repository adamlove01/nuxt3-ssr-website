import{a as K,_ as Q}from"./Update.DgFlZoIc.js";import{v as A,x as $,o as S,c as x,w as s,a as e,j as G,l as I,g as _,t as b,C as y,G as T,B as W,V as U,b as H,d as h,H as k,s as t,I as B,J as M,K as F,m as w,L as X,M as Y,N as Z,O as j,P as ee,A as L,_ as te,q as ae,u as le,y as se,z as ne,Q as oe,R as ie,i as ue,F as re,f as de,S as E,D}from"./entry.Dm-Fm04a.js";import"./paginateSchema.BkWWoeP8.js";import{a as N}from"./apiFetch.j0aHbuBY.js";import{u as me}from"./vue.f36acd1f.D7t288jC.js";const pe={class:"d-flex justify-space-between"},ce={class:"text-h5 align-self-center"},fe={__name:"Create",emits:["done"],setup(V,{emit:f}){const r=f;A();const i=$(null),p=$(!1),d=$(!1),n=$({name:"",email:"",password:"",role:"client",status:"active"}),g={};for(const u in n.value)g[u]=[()=>Z(u,n.value[u],j)];function c(){r("done",{status:"cancel"})}async function v(){p.value=!0;const[u,m]=await ee(n.value,j);if(u)return p.value=!1;const{status:l,code:a,field:P}=await N("/api/users/create",{method:"POST",body:n.value});return r("done",{status:l,message:L(a,P)})}return(u,m)=>(S(),x(Y,{ref_key:"form",ref:i,"validate-on":"blur lazy",onSubmit:X(v,["prevent"])},{default:s(()=>[e(G,null,{default:s(()=>[e(I,null,{default:s(()=>[_("div",pe,[_("span",ce,b(u.$t("users.addNewUser")),1),e(y,{icon:"mdi-close",class:"mr-n3",flat:"",onClick:c})])]),_:1}),e(T),e(W,{class:"pa-0"},{default:s(()=>[e(U,null,{default:s(()=>[e(H,null,{default:s(()=>[e(h,{cols:"12",class:"pb-0 mt-2"},{default:s(()=>[e(k,{modelValue:t(n).name,"onUpdate:modelValue":m[0]||(m[0]=l=>t(n).name=l),variant:"outlined",class:"mb-2",autocomplete:"name",label:u.$t("fields.fullName"),rules:g.name,required:""},null,8,["modelValue","label","rules"]),e(k,{modelValue:t(n).email,"onUpdate:modelValue":m[1]||(m[1]=l=>t(n).email=l),variant:"outlined",class:"mb-2",autocomplete:"email",label:u.$t("fields.email"),rules:g.email,required:""},null,8,["modelValue","label","rules"]),e(k,{modelValue:t(n).password,"onUpdate:modelValue":m[2]||(m[2]=l=>t(n).password=l),variant:"outlined",class:"mb-2",autocomplete:"current-password",label:u.$t("fields.password"),rules:g.password,"append-inner-icon":t(d)?"mdi-eye-outline":"mdi-eye-off-outline",type:t(d)?"text":"password",hint:u.$t("users.atLeast",{limit:8}),counter:"",required:"","onClick:appendInner":m[3]||(m[3]=l=>d.value=!t(d))},null,8,["modelValue","label","rules","append-inner-icon","type","hint"])]),_:1}),e(h,{cols:"12",sm:"6",class:"py-0"},{default:s(()=>[e(B,{modelValue:t(n).role,"onUpdate:modelValue":m[4]||(m[4]=l=>t(n).role=l),variant:"outlined",label:u.$t("fields.role"),items:u.$tm("fields.roleSelect")},null,8,["modelValue","label","items"])]),_:1}),e(h,{cols:"12",sm:"6",class:"py-0"},{default:s(()=>[e(B,{modelValue:t(n).status,"onUpdate:modelValue":m[5]||(m[5]=l=>t(n).status=l),variant:"outlined",label:u.$t("fields.status"),items:u.$tm("fields.statusSelect")},null,8,["modelValue","label","items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(T),e(M,{class:"mx-2 my-1"},{default:s(()=>[e(F),e(y,{variant:"flat",onClick:c},{default:s(()=>[w(b(u.$t("all.buttons.cancel")),1)]),_:1}),e(y,{disabled:t(p),loading:t(p),type:"submit",variant:"tonal","min-width":"100"},{default:s(()=>[w(b(u.$t("all.buttons.save")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},512))}},ge=fe,Ve={class:"d-flex justify-space-between"},ve={class:"text-h5 align-self-center"},be={__name:"Delete",props:{userData:{type:Object,required:!0,default:()=>({})}},emits:["reload","message"],setup(V,{emit:f}){const r=V,i=f,p=$({...r.userData});A();const d=$(!1);function n(){i("done",{status:"cancel"})}async function g(){d.value=!0;const{status:c,code:v,field:u}=await N(`/api/users/delete/${p.value.id}`,{method:"DELETE"});return i("done",{status:c,message:L(v,u)})}return(c,v)=>(S(),x(G,null,{default:s(()=>[e(I,null,{default:s(()=>[_("div",Ve,[_("span",ve,b(c.$t("users.deleteUser")),1),e(y,{icon:"mdi-close",class:"mr-n3",flat:"",onClick:n})])]),_:1}),e(T),e(W,{class:"pa-0"},{default:s(()=>[e(U,null,{default:s(()=>[e(H,null,{default:s(()=>[e(h,{cols:"12",class:"my-2"},{default:s(()=>[_("p",null,b(t(p).name),1),_("p",null,b(t(p).email),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(T),e(M,{class:"mx-2 my-1"},{default:s(()=>[e(F),e(y,{variant:"flat",onClick:n},{default:s(()=>[w(b(c.$t("all.buttons.cancel")),1)]),_:1}),e(y,{disabled:t(d),loading:t(d),variant:"tonal","min-width":"100",onClick:g},{default:s(()=>[w(b(c.$t("all.buttons.ok")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1}))}},$e=be;function O(V){return typeof V=="function"?V():t(V)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const q=()=>{};function we(V,f){function r(...i){return new Promise((p,d)=>{Promise.resolve(V(()=>f.apply(this,i),{fn:f,thisArg:this,args:i})).then(p).catch(d)})}return r}function ye(V,f={}){let r,i,p=q;const d=g=>{clearTimeout(g),p(),p=q};return g=>{const c=O(V),v=O(f.maxWait);return r&&d(r),c<=0||v!==void 0&&v<=0?(i&&(d(i),i=null),Promise.resolve(g())):new Promise((u,m)=>{p=f.rejectOnCancel?m:u,v&&!i&&(i=setTimeout(()=>{r&&d(r),i=null,u(g())},v)),r=setTimeout(()=>{i&&d(i),i=null,u(g())},c)})}}function _e(V,f=200,r={}){return we(ye(f,r),V)}const Pe={class:"flex-grow-1 ml-4"},Ce={__name:"admin",setup(V){me({title:ae("admin")});const f=le(),r=$({show:!1,string:null}),i=$({create:!1,update:!1,delete:!1}),p=$([]),d=$({}),n=$({page:1,itemsPerPage:10,sortBy:{key:"name",order:"desc"},search:null,column:"name",itemsLength:0,totalPages:0}),g=_e(()=>{n.value.search=r.value.string,c()},800);async function c(){const{status:l,code:a,field:P,details:C=null}=await N("/api/users/read",{method:"GET",params:n.value});if(l!=="success"){f.setBanner({type:l,title:L(a,P)});return}p.value=C.rows,n.value=C.options}se(async()=>{await ne(),c()});function v(l,a){d.value=l,i.value[a]=!0}function u(l,a){l.status!=="cancel"&&f.setBanner({type:l.status,title:l.message}),i.value[a]=!1,c()}function m(l,a){a==="page"&&(n.value.page=l),a==="itemsPerPage"&&(n.value.itemsPerPage=l),a==="sortBy"&&(n.value.sortBy=l[0]),c()}return(l,a)=>{const P=K,C=ge,R=Q,z=$e;return S(),x(U,{class:"bg_white_geometric",fluid:""},{default:s(()=>[e(P,{title:l.$t("all.titles.admin")},null,8,["title"]),e(U,{class:"pt-6"},{default:s(()=>[e(oe,{class:"elevation-1 pb2",headers:l.$tm("admin.headers"),items:t(p),page:t(n).page,"items-per-page":t(n).itemsPerPage,"items-per-page-text":l.$t("admin.itemsPerPageText"),"items-per-page-options":l.$tm("admin.itemsPerPageOptions"),"items-length":t(n).itemsLength,"show-current-page":!0,"onUpdate:page":a[4]||(a[4]=o=>m(o,"page")),"onUpdate:sortBy":a[5]||(a[5]=o=>m(o,"sortBy")),"onUpdate:itemsPerPage":a[6]||(a[6]=o=>m(o,"itemsPerPage"))},{top:s(()=>[e(ie,{flat:"",class:"py-0",title:l.$t("admin.usersList")},{default:s(()=>[e(F),t(r).show?(S(),ue(re,{key:0},[e(B,{modelValue:t(n).column,"onUpdate:modelValue":a[0]||(a[0]=o=>t(n).column=o),class:"search-columns mr-3",items:l.$tm("admin.columns"),placeholder:l.$t("admin.columnSearchPlaceholder"),label:"Search columns",variant:"outlined",density:"compact",multiple:"","hide-details":""},null,8,["modelValue","items","placeholder"]),e(k,{modelValue:t(r).string,"onUpdate:modelValue":[a[1]||(a[1]=o=>t(r).string=o),t(g)],class:"search mr-3",variant:"outlined",density:"compact",label:l.$t("fields.search"),autofocus:"","hide-details":""},null,8,["modelValue","label","onUpdate:modelValue"])],64)):de("",!0),e(y,{icon:"mdi-magnify",onClick:a[2]||(a[2]=o=>t(r).show=!t(r).show)}),e(y,{icon:"mdi-account-plus",onClick:a[3]||(a[3]=o=>t(i).create=!0)})]),_:1},8,["title"])]),"item.role":s(({item:o})=>[w(b(l.$t(`fields.roles.${o.role}`)),1)]),"item.status":s(({item:o})=>[w(b(l.$t(`fields.statuses.${o.status}`)),1)]),"item.actions":s(({item:o})=>[e(E,{small:"",class:"mr-4",onClick:J=>v(o,"update")},{default:s(()=>[w(" mdi-pencil ")]),_:2},1032,["onClick"]),e(E,{small:"",onClick:J=>v(o,"delete")},{default:s(()=>[w(" mdi-delete ")]),_:2},1032,["onClick"])]),"footer.prepend":s(()=>[_("p",Pe,b(l.$t("admin.pages"))+" "+b(t(n).totalPages),1)]),_:1},8,["headers","items","page","items-per-page","items-per-page-text","items-per-page-options","items-length"]),e(D,{modelValue:t(i).create,"onUpdate:modelValue":a[8]||(a[8]=o=>t(i).create=o),"max-width":"500px"},{default:s(()=>[e(C,{onDone:a[7]||(a[7]=o=>u(o,"create"))})]),_:1},8,["modelValue"]),e(D,{modelValue:t(i).update,"onUpdate:modelValue":a[10]||(a[10]=o=>t(i).update=o),"max-width":"500px"},{default:s(()=>[e(R,{"user-data":t(d),onDone:a[9]||(a[9]=o=>u(o,"update"))},null,8,["user-data"])]),_:1},8,["modelValue"]),e(D,{modelValue:t(i).delete,"onUpdate:modelValue":a[12]||(a[12]=o=>t(i).delete=o),"max-width":"500px"},{default:s(()=>[e(z,{"user-data":t(d),onDone:a[11]||(a[11]=o=>u(o,"delete"))},null,8,["user-data"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}},De=te(Ce,[["__scopeId","data-v-6650cfd6"]]);export{De as default};
